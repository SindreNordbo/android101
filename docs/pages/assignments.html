---
layout: default
title: Assignments
---

<h3>1. Displaying the messages</h3>
<ol>
  <li>Create a MessagesActivity and corresponding layout. Add a RecyclerView to the layout and get a reference to it in the activity.</li>
  <code>compile 'com.android.support:recyclerview-v7:+'</code>
  <li>Create a layout file for displaying messages in the list, f. ex /res/layout/item_message.xml, and put in some views to display the message sender, text and date.</li>
  <li>Create a MessagesAdapter class that extends RecyclerView.Adapter and implement the required methods.</li>
  <li>Use Retrofit to create a client for the REST API and fetch the messages asynchronously.</li>
  <li>Add the received messages to the adapter and notify it of the changed message list.</li>
</ol>

<h4>Hints</h4>
<ul>
  <li>The ViewHolder you create should contain references to all the TextViews you need to show for each position in the message list.</li>
  <li>You will need a <code>LayoutInflater</code> in MessagesAdapter in <code>onCreateViewHolder</code> to create the layout view of the message. It is probably easiest to use Activitys <code>getLayoutInflater()</code> and pass it to the adapter.</li>
  <li>Store a reference to the list of messages in MessagesAdapter. When you have added some messages to the list, call <code>notifyDataSetChanged</code> on the adapter, and it will render the messages again.</li>
</ul>

<h3>2. Sending a new message</h3>
<ol>
  <li>Create a NewMessageActivity and corresponding layout with some EditText views to fill in the sender and the message text.</li>
  <li>Create a send button and add an OnClickListener that will create a new Message object based on the input views.</li>
  <li>Extend the client Retrofit API with a send message operation and call it in the OnClickListener.</li>
  <li>Show the MessagesActivity with the updated message list.</li>
</ol>

<h4>Hints</h4>
<ul>
  <li>Use <code>NewMessageActivity.this.finish();</code> to navigate back to the previous Activity.</li>
</ul>

<h3>3. Show images</h3>
<ol>
  <li>Add an ImageView in your message layout (e.g. item_message.xml).</li>
  <li>In <code>onBindViewHolder</code> in MessagesAdapter, use the Picasso image loader library to load the image from a url if it exists for that message.</li>
</ol>

<h4>Hints</h4>
<ul>
  <li>Add the Picasso dependency to your app.gradle file: compile 'com.squareup.picasso:picasso:2.5.2'.</li>
</ul>

<h3>4. Use the camera to add images to your messages</h3>
<ol>
  <li>Add a button in your new message layout and add an OnClickListener for it in NewMessageActivity.</li>
  <li>In the listener, start the image capture by using an Intent.</li>
  <li>Override <code>onActivityResult(...)</code> to receive to captured photo.</li>
  <li>Use the provided ImgurUpload class to upload the photo to Imgur.</li>
  <li>Set the imgur url on the message and post it as before.</li>
</ol>

<h4>Store the captured photo in external storage</h4>
Use <code>intent.putExtra(MediaStore.EXTRA_OUTPUT, imageFileUri)</code> on your camera intent to store the photo on external storage. In <code>onActivityResult(...)</code> you can use <code>BitmapFactory.decodeFile(...)</code> to get the photo.
{% highlight java %}
String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss").format(new Date());
String imageFilePath = Environment.getExternalStorageDirectory().toString()+"/Android/data/no.bekk.android.messages/Image-"+timeStamp+".png";
File imageFile = new File(imageFilePath);
Uri imageFileUri = Uri.fromFile(imageFile); // convert path to Uri
{% endhighlight %}

<h3>5. Improve the design or implement more API operations. Choose 5a or 5b.</h3>

<h3>5a. Improve design</h3>
<ol>
  <li>Use a android.support.v7.widget.CardView in the item_message layout and make it look good.</li>
  <li>Add a Lollipop toolbar to your app by using the support library (android.support.v7.widget.Toolbar). Put it in a separate layout file so that you can include it in all activities. Style it with a theme.</li>
  <li>Use com.amulyakhare:com.amulyakhare.textdrawable to display a colored box for each message with the first letter of recipients name, ala. Gmail. Use ColorGenerator with material design colors.</li>
  <li>By using the library com.github.shell-software:fab, add a FAB button (again, like Gmail) for creating a new message.</li>
</ol>

<h3>5b. Edit and delete messages</h3>
<ol>
  <li>Add an EditMessageActivity. Try to reuse the layout for NewMessageActivity as much as you can.</li>
  <li>Implement delete. You can f. ex have add a delete button in EditMessageActivity or delete by long-pressing messages in the list.</li>
</ol>

<h4>Hints</h4>
<ul>
  <li>To pass objects between activities in intents, you can serialize them using Gson, and pass the serialized string instead. Convert back from json to java at the destination activity.</li>
</ul>

<h3>6. Android Wear</h3>

For theory on Android Wear, take a look at our
<a href="http://bekk.github.io/android-wear-kurs/">  Android Wear workshop</a> or the <a href="https://developer.android.com/wear/index.html"> developer docs</a>. All material in the Android Wear workshop is in Norwegian.

<ol>
  <li>Show the list of messages on an Android Wear device, using either a DataListener or a WearableListenerService. When a list element on the watch is tapped, open it on the mobile device.</li>
  <li>Add deletion of messages.</li>
  <li>Create a message using speech-to-text.</li>
</ol>

<h3>API</h3>

<p>The server is at: <a href="http://mobile-course.herokuapp.com">
		http://mobile-course.herokuapp.com</a></p>

<p>
It hosts the following JSON endpoints:
<table class="table table-bordered">
	<thead>
		<tr>
			<th>URL</th>
			<th>HTTP verb</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody>
	<tr>
		<td><a href="http://mobile-course.herokuapp.com/message">http://mobile-course.herokuapp.com/message</a></td>
		<td>GET</td>
		<td>Retrieves all messages</td>
	</tr>
	<tr>
		<td><a href="http://mobile-course.herokuapp.com/message">http://mobile-course.herokuapp.com/message</a></td>
		<td>POST</td>
		<td>Creates a message(see JSON example below)</td>
	</tr>
	<tr>
		<td><a href="http://mobile-course.herokuapp.com/:id">http://mobile-course.herokuapp.com/message/:id</a></td>
		<td>PUT</td>
		<td>Updates a message</td>
	</tr>
	<tr>
		<td><a href="http://mobile-course.herokuapp.com/:id">http://mobile-course.herokuapp.com/message/:id</a></td>
		<td>DELETE</td>
		<td>Deletes a message</td>
	</tr>
	</tbody>
</table>

<h3>POST example</h3>

{% gist 0a2f2c1a6419dc28de22 %}

<h3>Uploading to Imgur</h3>

{% gist 1b9a5cee635c52249fd2 %}

<h3> Retrofit </h3>
If you want to use retrofit, you will need the following gradle dependency:
<code>compile 'com.squareup.retrofit:retrofit:1.9.0'</code>.

If you want to do things manually and need a framework for JSON-parsing, we suggest using Gson.
