<!DOCTYPE html>
<html lang="nb">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Lists and RecyclerView</title>
        <meta name="viewport" content="width=device-width">

        <link rel="stylesheet" href="/android101/css/syntax.css">
        <link href="/android101/css/bootstrap.min.css" rel="stylesheet" media="screen">
        <link rel="stylesheet" href="/android101/css/main.css">
        <script src="/android101/js/jquery.min.js"></script>
        <script src="/android101/js/bootstrap.min.js"></script>

    </head>
    <body>
      <div class="container-fluid main">
        <div class="row-fluid">
          <div class="span8">
            <h1 class="page-header">Lists and RecyclerView</h1>
            When we work with lists in Android, we first create a model to hold the data we want to display:
<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Message</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">DateTime</span> <span class="n">date</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">from</span><span class="o">,</span> <span class="n">message</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Message</span><span class="o">(</span><span class="n">String</span> <span class="n">from</span><span class="o">,</span> <span class="n">String</span> <span class="n">message</span><span class="o">,</span> <span class="n">DateTime</span> <span class="n">date</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">date</span> <span class="o">=</span> <span class="n">date</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">from</span> <span class="o">=</span> <span class="n">from</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getFrom</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">from</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getMessage</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">DateTime</span> <span class="nf">getDate</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">date</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>
Then, we create a layout xml file used for each message in the list. The views you declare here will end up in each row of the list, and you will be populate each row with the right data. We place this file in
<code>res/layout/item_message.xml</code>.

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

    <span class="nt">&lt;RelativeLayout</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span>
            <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
            <span class="na">android:padding=</span><span class="s">&quot;10dp&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;TextView</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:id=</span><span class="s">&quot;@+id/tvFrom&quot;</span>
                <span class="na">android:text=</span><span class="s">&quot;From:&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;TextView</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:id=</span><span class="s">&quot;@+id/tvMessage&quot;</span>
                <span class="na">android:text=</span><span class="s">&quot;Message body&quot;</span><span class="nt">/&gt;</span>

            <span class="nt">&lt;TextView</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:id=</span><span class="s">&quot;@+id/tvDate&quot;</span>
                <span class="na">android:text=</span><span class="s">&quot;Timestamp&quot;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/RelativeLayout&gt;</span></code></pre></figure>
For displaying data in lists, we use what is called a <code>RecyclerView</code>. It uses an <code>Adapter</code> to control the display of each item in the list by asking you to first create a view for each position, and then define a way to update these views for the data at each position. We use a helper object called a <code>ViewHolder</code> that stores references to all the views we need for each row, e.g. a TextView for displaying an item name and a button for taking some action. We create this object in <code>onCreateViewHolder</code> using a <code>LayoutInflater</code> to create the item layout, and then <code>findViewById</code> to obtain references to the subviews. In <code>onBindViewHolder</code> we use the ViewHolder to get the stored TextView for this particular row and update the text displayed to the message text for this position in the list.

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ppublic</span> <span class="kd">class</span> <span class="nc">MessagesAdapter</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">Adapter</span><span class="o">&lt;</span><span class="n">MessagesAdapter</span><span class="o">.</span><span class="na">MessagesViewHolder</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">LayoutInflater</span> <span class="n">inflater</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;</span> <span class="n">messages</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">MessagesAdapter</span><span class="o">(</span><span class="n">LayoutInflater</span> <span class="n">inflater</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;</span> <span class="n">messages</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">inflater</span> <span class="o">=</span> <span class="n">inflater</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">messages</span> <span class="o">=</span> <span class="n">messages</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">MessagesViewHolder</span> <span class="nf">onCreateViewHolder</span><span class="o">(</span><span class="n">ViewGroup</span> <span class="n">parent</span><span class="o">,</span> <span class="kt">int</span> <span class="n">viewType</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">View</span> <span class="n">itemMessage</span> <span class="o">=</span> <span class="n">inflater</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">item_message</span><span class="o">,</span> <span class="n">parent</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
        <span class="n">MessagesViewHolder</span> <span class="n">messagesViewHolder</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">MessagesViewHolder</span><span class="o">(</span><span class="n">itemMessage</span><span class="o">,</span> <span class="n">tapDelegate</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
        <span class="n">messagesViewHolder</span><span class="o">.</span><span class="na">view</span> <span class="o">=</span> <span class="n">itemMessage</span><span class="o">;</span>
        <span class="n">messagesViewHolder</span><span class="o">.</span><span class="na">from</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">itemMessage</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvFrom</span><span class="o">);</span>
        <span class="n">messagesViewHolder</span><span class="o">.</span><span class="na">message</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">itemMessage</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvMessage</span><span class="o">);</span>
        <span class="n">messagesViewHolder</span><span class="o">.</span><span class="na">date</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">itemMessage</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">tvDate</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">messagesViewHolder</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBindViewHolder</span><span class="o">(</span><span class="n">MessagesViewHolder</span> <span class="n">holder</span><span class="o">,</span> <span class="kt">int</span> <span class="n">position</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Message</span> <span class="n">message</span> <span class="o">=</span> <span class="n">messages</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">position</span><span class="o">);</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">from</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="na">getFrom</span><span class="o">());</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">message</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">date</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">message</span><span class="o">.</span><span class="na">getDateTimeString</span><span class="o">());</span>
        <span class="n">holder</span><span class="o">.</span><span class="na">position</span> <span class="o">=</span> <span class="n">position</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getItemCount</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">messages</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MessagesViewHolder</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span> <span class="o">{</span>
        <span class="n">View</span> <span class="n">view</span><span class="o">;</span>
        <span class="n">TextView</span> <span class="n">from</span><span class="o">,</span> <span class="n">message</span><span class="o">,</span> <span class="n">date</span><span class="o">;</span>
        <span class="kt">int</span> <span class="n">position</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">MessagesViewHolder</span><span class="o">(</span><span class="n">View</span> <span class="n">itemView</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">itemView</span><span class="o">);</span>
            <span class="k">this</span><span class="o">.</span><span class="na">view</span> <span class="o">=</span> <span class="n">itemView</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

The <code>MessagesViewHolder</code> caches the view elements for quicker access. The <code>MessagesAdapter</code> provides access to the data set, as well as provides the correct view elements. In our example this is seen by the <code>itemMessage.findViewById()</code> calls.

We also need a <code>LayoutManager</code>, for the layout of child views. To display a list, the <code>LinearLayoutManager</code> is the chosen layout manager. It can display items either vertically or horizontally.

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">myRecyclerView</span><span class="o">.</span><span class="na">setLayoutManager</span><span class="o">(</span><span class="k">new</span> <span class="nf">LinearLayoutManager</span><span class="o">(</span><span class="k">this</span><span class="o">));</span></code></pre></figure>

In the activity where we want to display a list, we get the <code>RecyclerView</code> from the activity layout using the id <code>R.id.messageList</code> and set it to use our adapter and a LayoutManager. 

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;</span> <span class="n">messages</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Message</span><span class="o">&gt;();</span>
<span class="n">RecyclerView</span> <span class="n">msgView</span> <span class="o">=</span> <span class="o">(</span><span class="n">RecyclerView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">messageList</span><span class="o">);</span>
<span class="n">msgView</span><span class="o">.</span><span class="na">setLayoutManager</span><span class="o">(</span><span class="k">new</span> <span class="nf">LinearLayoutManager</span><span class="o">(</span><span class="k">this</span><span class="o">));</span>
<span class="n">MessagesAdapter</span> <span class="n">msgAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">MessagesAdapter</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getLayoutInflater</span><span class="o">(),</span> <span class="n">messages</span><span class="o">,</span> <span class="k">this</span><span class="o">,</span> <span class="k">this</span><span class="o">);</span>
<span class="n">msgView</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">msgAdapter</span><span class="o">);</span></code></pre></figure>

          </div>
          <nav class="span4">
            <strong>Android</strong>
            
<ul class="nav nav-pills nav-stacked">

  

  

  
    
      <li class=""><a href="/android101/pages/android-app-structure-and-components.html">App Structure and Components</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/view-layout.html">View Layout</a></li>
    
  
    
  


  

  

  
    
  
    
  
    
      <li class=""><a href="/android101/pages/common-view-controls.html">Common View Controls</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  

  
    
  
    
  
    
  
    
  
    
      <li class="active"><a href="/android101/pages/list-recycler-view.html">Lists and RecyclerView</a></li>
    
  
    
  
    
  
    
  
    
  
    
  

  
</ul>
            
            <strong>Network Communication</strong>
            
<ul class="nav nav-pills nav-stacked">

  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/working-in-the-background.html">Working In the Background</a></li>
    
  


  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/retrofit.html">Consume REST APIs with Retrofit</a></li>
    
  
    
  
    
  

  
</ul>

            <strong>Workshop</strong>
            
<ul class="nav nav-pills nav-stacked">

  

  

  
    
  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/prerequisites.html">Prerequisites</a></li>
    
  
    
  
    
  
    
  


  

  

  
    
  
    
      <li class=""><a href="/android101/pages/assignments.html">Assignments</a></li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


  

  

  
    
  
    
  
    
  
    
  
    
  
    
      <li class=""><a href="/android101/pages/manuscript.html">Manuscript</a></li>
    
  
    
  
    
  
    
  
    
  

  
</ul>
          </nav>
        </div>
      </div>

    </body>
</html>
